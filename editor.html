<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–†–µ–¥–∞–∫—Ç–æ—Ä –∫–∞–ª–µ–Ω–¥–∞—Ä—è —Ñ—É—Ä—Ä–∏-—Å–æ–±—ã—Ç–∏–π 2026</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f8fafc; padding: 20px; color: #1e293b; }
    .container { max-width: 1200px; margin: 0 auto; }
    
    .header { 
      background: linear-gradient(135deg, #d946ef, #a21caf); 
      color: white; 
      padding: 25px; 
      border-radius: 16px; 
      margin-bottom: 25px; 
      text-align: center;
      box-shadow: 0 10px 25px rgba(217, 70, 239, 0.2);
    }
    
    .status { 
      padding: 15px; 
      margin-bottom: 20px; 
      border-radius: 10px; 
      display: none;
      font-weight: 500;
    }
    .success { background: linear-gradient(135deg, #10b981, #059669); color: white; }
    .error { background: linear-gradient(135deg, #ef4444, #dc2626); color: white; }
    .info { background: linear-gradient(135deg, #3b82f6, #2563eb); color: white; }
    
    .card { 
      background: white; 
      padding: 25px; 
      border-radius: 16px; 
      margin-bottom: 25px; 
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      border: 1px solid #e2e8f0;
    }
    
    h2 { margin-bottom: 20px; color: #0f172a; font-weight: 700; font-size: 1.5rem; }
    
    .form-grid { 
      display: grid; 
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); 
      gap: 20px; 
      margin-bottom: 20px;
    }
    
    .form-group { margin-bottom: 20px; }
    label { display: block; margin-bottom: 8px; font-weight: 600; color: #475569; font-size: 0.95rem; }
    .required::after { content: " *"; color: #ef4444; }
    input, select, textarea { 
      width: 100%; 
      padding: 12px 15px; 
      border: 2px solid #e2e8f0; 
      border-radius: 10px; 
      font-size: 15px;
      transition: all 0.3s;
      background: #f8fafc;
    }
    input:focus, select:focus, textarea:focus { 
      outline: none; 
      border-color: #d946ef; 
      background: white;
      box-shadow: 0 0 0 3px rgba(217, 70, 239, 0.1);
    }
    textarea { min-height: 100px; resize: vertical; font-family: inherit; }
    .color-preview { width: 40px; height: 40px; border-radius: 8px; border: 3px solid white; box-shadow: 0 2px 8px rgba(0,0,0,0.15); }
    
    .btn { 
      padding: 14px 28px; 
      border: none; 
      border-radius: 12px; 
      cursor: pointer; 
      font-weight: 600;
      font-size: 15px;
      transition: all 0.3s;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    .btn-primary { 
      background: linear-gradient(135deg, #d946ef, #a21caf); 
      color: white; 
      box-shadow: 0 4px 12px rgba(217, 70, 239, 0.3);
    }
    .btn-primary:hover { 
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(217, 70, 239, 0.4);
    }
    .btn-secondary { 
      background: linear-gradient(135deg, #64748b, #475569); 
      color: white; 
      box-shadow: 0 4px 12px rgba(100, 116, 139, 0.3);
    }
    .btn-secondary:hover { 
      background: linear-gradient(135deg, #475569, #334155);
      transform: translateY(-2px);
    }
    .btn-danger { 
      background: linear-gradient(135deg, #ef4444, #dc2626); 
      color: white; 
      box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
    }
    .btn-danger:hover { 
      background: linear-gradient(135deg, #dc2626, #b91c1c);
      transform: translateY(-2px);
    }
    .btn-success { 
      background: linear-gradient(135deg, #10b981, #059669); 
      color: white; 
      box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
    }
    .btn-success:hover { 
      background: linear-gradient(135deg, #059669, #047857);
      transform: translateY(-2px);
    }
    
    .events-list { max-height: 600px; overflow-y: auto; padding-right: 10px; }
    .event-item { 
      background: white; 
      padding: 20px; 
      margin-bottom: 15px; 
      border-radius: 14px; 
      border-left: 5px solid #d946ef;
      border: 1px solid #e2e8f0;
      transition: all 0.3s;
    }
    .event-item:hover { 
      transform: translateX(5px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
      border-left-color: #a21caf;
    }
    .event-header { 
      display: flex; 
      justify-content: space-between; 
      align-items: flex-start;
      margin-bottom: 15px;
      flex-wrap: wrap;
      gap: 15px;
    }
    .event-title { font-weight: 700; color: #0f172a; font-size: 1.1rem; margin-bottom: 5px; }
    .event-dates { 
      color: #64748b; 
      font-size: 0.9rem; 
      display: flex; 
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }
    .event-actions { display: flex; gap: 10px; }
    
    .password-screen { 
      position: fixed; 
      top: 0; left: 0; 
      width: 100%; height: 100%; 
      background: linear-gradient(135deg, #f8fafc, #e2e8f0); 
      display: flex; 
      flex-direction: column; 
      justify-content: center; 
      align-items: center; 
      z-index: 1000;
      padding: 20px;
    }
    .password-form { 
      max-width: 450px; 
      width: 100%; 
      background: white; 
      padding: 40px;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
      text-align: center;
    }
    
    .instructions {
      background: linear-gradient(135deg, #fef3c7, #fde68a);
      border: 2px solid #f59e0b;
      border-radius: 14px;
      padding: 25px;
      margin-top: 30px;
    }
    .instructions h3 { color: #92400e; margin-bottom: 15px; font-weight: 700; }
    .instructions ol { margin-left: 20px; margin-bottom: 15px; }
    .instructions li { margin-bottom: 8px; line-height: 1.5; }
    .instructions code {
      background: rgba(0, 0, 0, 0.08);
      padding: 3px 8px;
      border-radius: 6px;
      font-family: 'Courier New', monospace;
      font-size: 0.9em;
    }
    
    .category-badge {
      display: inline-flex;
      align-items: center;
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 600;
      gap: 6px;
    }
    
    .stat-box {
      display: flex;
      gap: 20px;
      margin-bottom: 25px;
      flex-wrap: wrap;
    }
    .stat-item {
      background: white;
      padding: 20px;
      border-radius: 14px;
      flex: 1;
      min-width: 180px;
      text-align: center;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      border: 1px solid #e2e8f0;
    }
    .stat-number {
      font-size: 2.5rem;
      font-weight: 800;
      color: #d946ef;
      line-height: 1;
      margin-bottom: 8px;
    }
    .stat-label {
      color: #64748b;
      font-size: 0.95rem;
      font-weight: 600;
    }
    
    .empty-state {
      text-align: center;
      padding: 50px 20px;
      color: #94a3b8;
    }
    .empty-state svg {
      width: 80px;
      height: 80px;
      margin-bottom: 20px;
      opacity: 0.5;
    }
    
    .toggle-password {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: #64748b;
      cursor: pointer;
    }
    
    .color-hint {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-top: 8px;
      font-size: 0.85rem;
      color: #64748b;
    }
    .color-hint span {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      display: inline-block;
    }
    
    @media (max-width: 768px) {
      body { padding: 15px; }
      .header { padding: 20px; }
      .card { padding: 20px; }
      .btn { padding: 12px 20px; }
      .event-header { flex-direction: column; }
      .event-actions { width: 100%; }
      .event-actions button { flex: 1; }
    }
  </style>
</head>
<body>
  <!-- –≠–∫—Ä–∞–Ω –≤–≤–æ–¥–∞ –ø–∞—Ä–æ–ª—è -->
  <div id="passwordScreen" class="password-screen">
    <div class="header" style="max-width: 450px; width: 100%; margin-bottom: 30px;">
      <h1 style="font-size: 2rem; margin-bottom: 10px;">üîê –†–µ–¥–∞–∫—Ç–æ—Ä –∫–∞–ª–µ–Ω–¥–∞—Ä—è</h1>
      <p style="margin-top: 10px; opacity: 0.9; font-size: 1.1rem;">–¢–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</p>
    </div>
    <div class="password-form">
      <div style="margin-bottom: 25px;">
        <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="#d946ef" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
          <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
        </svg>
      </div>
      <h2 style="margin-bottom: 25px; color: #0f172a;">–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞</h2>
      <div class="form-group" style="position: relative;">
        <input type="password" id="password" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" style="padding-right: 50px;">
        <button type="button" class="toggle-password" onclick="togglePasswordVisibility()">üëÅÔ∏è</button>
      </div>
      <button onclick="checkPassword()" class="btn btn-primary" style="width: 100%; margin-top: 10px; padding: 15px;">
        <span>üîì –í–æ–π—Ç–∏ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä</span>
      </button>
      <div id="passwordError" style="color: #ef4444; margin-top: 15px; display: none; font-weight: 500;">
        ‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.
      </div>
      <div style="margin-top: 25px; padding-top: 20px; border-top: 1px solid #e2e8f0; color: #94a3b8; font-size: 0.9rem;">
        <p>üîí –î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è</p>
      </div>
    </div>
  </div>

  <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç (—Å–∫—Ä—ã—Ç –¥–æ –≤–≤–æ–¥–∞ –ø–∞—Ä–æ–ª—è) -->
  <div class="container" id="mainContent" style="display: none;">
    <!-- –°—Ç–∞—Ç—É—Å —Å–æ–æ–±—â–µ–Ω–∏—è -->
    <div id="statusMessage" class="status"></div>

    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
    <div class="header">
      <h1 style="font-size: 2.2rem; margin-bottom: 10px;">üìÖ –†–µ–¥–∞–∫—Ç–æ—Ä —Ñ—É—Ä—Ä–∏-–∫–∞–ª–µ–Ω–¥–∞—Ä—è 2026</h1>
      <p style="margin-top: 10px; opacity: 0.9; font-size: 1.1rem;">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ü–≤–µ—Ç–∞ –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</p>
      <div style="display: flex; gap: 15px; justify-content: center; margin-top: 20px; flex-wrap: wrap;">
        <button onclick="saveToFile()" class="btn btn-success">
          <span>üíæ –°–∫–∞—á–∞—Ç—å events.json</span>
        </button>
        <button onclick="logout()" class="btn btn-secondary">
          <span>üö™ –í—ã–π—Ç–∏</span>
        </button>
      </div>
    </div>

    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div class="stat-box">
      <div class="stat-item">
        <div class="stat-number" id="totalEvents">0</div>
        <div class="stat-label">–í—Å–µ–≥–æ —Å–æ–±—ã—Ç–∏–π</div>
      </div>
      <div class="stat-item">
        <div class="stat-number" id="upcomingEvents">0</div>
        <div class="stat-label">–ë–ª–∏–∂–∞–π—à–∏–µ —Å–æ–±—ã—Ç–∏—è</div>
      </div>
      <div class="stat-item">
        <div class="stat-number" id="tentativeCount">0</div>
        <div class="stat-label">–ü–æ–¥ –≤–æ–ø—Ä–æ—Å–æ–º</div>
      </div>
      <div class="stat-item">
        <div class="stat-number" id="lastUpdate">‚Äì</div>
        <div class="stat-label">–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ</div>
      </div>
    </div>

    <!-- –õ–µ–≥–µ–Ω–¥–∞ —Ü–≤–µ—Ç–æ–≤ -->
    <div class="card" style="padding: 20px;">
      <h3 style="margin-bottom: 15px;">üé® –¶–≤–µ—Ç–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π</h3>
      <div style="display: flex; gap: 20px; flex-wrap: wrap;">
        <div class="color-hint">
          <span style="background-color: #3b82f6;"></span>
          <span>–ö–æ–Ω–≤–µ–Ω—Ç</span>
        </div>
        <div class="color-hint">
          <span style="background-color: #10b981;"></span>
          <span>–ö–µ–º–ø–∏–Ω–≥</span>
        </div>
        <div class="color-hint">
          <span style="background-color: #f59e0b;"></span>
          <span>–ú–∞—Ä–∫–µ—Ç</span>
        </div>
        <div class="color-hint">
          <span style="background-color: #6b7280;"></span>
          <span>–ü–æ–¥ –≤–æ–ø—Ä–æ—Å–æ–º</span>
        </div>
        <div class="color-hint">
          <span style="background-color: #d946ef; border: 1px dashed #666;"></span>
          <span>–°–≤–æ–π —Ü–≤–µ—Ç (–≤—Ä—É—á–Ω—É—é)</span>
        </div>
      </div>
    </div>

    <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏—è -->
    <div class="card">
      <h2 id="formTitle">‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ</h2>
      <div class="form-grid">
        <div class="form-group">
          <label for="eventId" class="required">ID —Å–æ–±—ã—Ç–∏—è (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π)</label>
          <input type="text" id="eventId" placeholder="wintertails-2026-01" required>
          <div style="font-size: 0.85rem; color: #64748b; margin-top: 5px;">–¢–æ–ª—å–∫–æ –ª–∞—Ç–∏–Ω—Å–∫–∏–µ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã –∏ –¥–µ—Ñ–∏—Å—ã</div>
        </div>
        <div class="form-group">
          <label for="eventTitle" class="required">–ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è</label>
          <input type="text" id="eventTitle" placeholder="–í–∏–Ω—Ç–µ—Ä—Ç–µ–π–ª–∑" required>
        </div>
        <div class="form-group">
          <label for="startDate" class="required">–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞</label>
          <input type="date" id="startDate" value="2026-01-01" required>
        </div>
        <div class="form-group">
          <label for="endDate" class="required">–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è</label>
          <input type="date" id="endDate" value="2026-01-01" required>
        </div>
        <div class="form-group">
          <label for="category" class="required">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
          <select id="category" required onchange="updateColorByCategory()">
            <option value="convention">üé™ –ö–æ–Ω–≤–µ–Ω—Ç (—Å–∏–Ω–∏–π)</option>
            <option value="camping">üèïÔ∏è –ö–µ–º–ø–∏–Ω–≥ (–∑–µ–ª—ë–Ω—ã–π)</option>
            <option value="meetup">üõçÔ∏è –ú–∞—Ä–∫–µ—Ç (–æ—Ä–∞–Ω–∂–µ–≤—ã–π)</option>
            <option value="tentative">‚ùì –ü–æ–¥ –≤–æ–ø—Ä–æ—Å–æ–º (—Å–µ—Ä—ã–π)</option>
          </select>
        </div>
        <div class="form-group">
          <label for="color">
            –¶–≤–µ—Ç —Å–æ–±—ã—Ç–∏—è 
            <span id="colorStatus" style="font-size: 0.85rem; color: #64748b; margin-left: 8px;">(–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π)</span>
          </label>
          <div style="display: flex; gap: 15px; align-items: center; margin-top: 8px;">
            <input type="color" id="color" value="#3b82f6" style="width: 60px; height: 50px; padding: 0;" oninput="manualColorChange()">
            <div class="color-preview" id="colorPreview"></div>
            <button type="button" onclick="resetToAutoColor()" class="btn btn-secondary" style="padding: 8px 12px; font-size: 0.85rem;">
              üîÑ –ê–≤—Ç–æ
            </button>
          </div>
          <div class="color-hint">
            <span id="currentCategoryColor" style="background-color: #3b82f6;"></span>
            <span id="currentCategoryText">–¶–≤–µ—Ç –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–ö–æ–Ω–≤–µ–Ω—Ç"</span>
          </div>
        </div>
        <div class="form-group">
          <label for="location">üìç –ú–µ—Å—Ç–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è</label>
          <input type="text" id="location" placeholder="–ú–æ—Å–∫–≤–∞, –ê—Ä—Ç-—Ö–æ–ª–ª –õ—É–∂–Ω–∏–∫–∏">
        </div>
        <div class="form-group">
          <label for="url">üîó –°—Å—ã–ª–∫–∞ (Telegram, VK, —Å–∞–π—Ç)</label>
          <input type="url" id="url" placeholder="https://t.me/...">
        </div>
      </div>
      <div class="form-group">
        <label for="description">üìù –û–ø–∏—Å–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è</label>
        <textarea id="description" placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è, —Ü–µ–Ω–∞ –±–∏–ª–µ—Ç–æ–≤, –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è, –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏..."></textarea>
      </div>
      
      <div style="display: flex; gap: 15px; margin-top: 30px; flex-wrap: wrap;">
        <button onclick="saveEvent()" class="btn btn-primary">
          <span>üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ</span>
        </button>
        <button onclick="clearForm()" class="btn btn-secondary">
          <span>üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É</span>
        </button>
        <button onclick="addSampleEvent()" class="btn btn-secondary">
          <span>üé≤ –ü—Ä–∏–º–µ—Ä —Å–æ–±—ã—Ç–∏—è</span>
        </button>
      </div>
    </div>

    <!-- –°–ø–∏—Å–æ–∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å–æ–±—ã—Ç–∏–π -->
    <div class="card">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h2>üìã –í—Å–µ —Å–æ–±—ã—Ç–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è</h2>
        <div style="display: flex; gap: 10px;">
          <input type="text" id="searchEvents" placeholder="–ü–æ–∏—Å–∫ —Å–æ–±—ã—Ç–∏–π..." style="width: 250px; padding: 10px 15px;">
          <select id="filterCategory" style="width: 180px;">
            <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
            <option value="convention">–ö–æ–Ω–≤–µ–Ω—Ç—ã</option>
            <option value="camping">–ö–µ–º–ø–∏–Ω–≥–∏</option>
            <option value="meetup">–ú–∞—Ä–∫–µ—Ç—ã</option>
          </select>
        </div>
      </div>
      <div id="eventsList" class="events-list">
        <!-- –°–æ–±—ã—Ç–∏—è –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —Å—é–¥–∞ -->
        <div class="empty-state">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
          </svg>
          <p style="font-size: 1.1rem; margin-bottom: 10px;">–ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ–±—ã—Ç–∏—è...</p>
          <p style="color: #94a3b8;">–ï—Å–ª–∏ —Å–æ–±—ã—Ç–∏—è –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∏—Å—å, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª events.json</p>
        </div>
      </div>
    </div>

    <!-- –°–æ–±—ã—Ç–∏—è –ø–æ–¥ –≤–æ–ø—Ä–æ—Å–æ–º -->
    <div class="card">
      <h2>‚ùì –°–æ–±—ã—Ç–∏—è –ø–æ–¥ –≤–æ–ø—Ä–æ—Å–æ–º</h2>
      <p style="color: #64748b; margin-bottom: 20px; font-size: 0.95rem;">–°–æ–±—ã—Ç–∏—è —Å –Ω–µ–ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–º–∏ –¥–∞—Ç–∞–º–∏. –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ –æ—Å–Ω–æ–≤–Ω—ã–µ, —É–∫–∞–∑–∞–≤ —Ç–æ—á–Ω—ã–µ –¥–∞—Ç—ã.</p>
      <div id="tentativeEventsList" class="events-list">
        <!-- –°–æ–±—ã—Ç–∏—è –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —Å—é–¥–∞ -->
      </div>
    </div>

    <!-- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ -->
    <div class="instructions">
      <h3>üìö –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–º</h3>
      <ol>
        <li><strong>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ü–≤–µ—Ç–∞</strong>: –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ü–≤–µ—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</li>
        <li><strong>–†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞</strong>: –ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —Ü–≤–µ—Ç –≤—Ä—É—á–Ω—É—é, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ</li>
        <li><strong>–°–±—Ä–æ—Å —Ü–≤–µ—Ç–∞</strong>: –ö–Ω–æ–ø–∫–∞ "–ê–≤—Ç–æ" –≤–µ—Ä–Ω—ë—Ç —Ü–≤–µ—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</li>
        <li><strong>–°–∫–∞—á–∞—Ç—å –∏ –æ–±–Ω–æ–≤–∏—Ç—å</strong>: –ù–∞–∂–º–∏—Ç–µ "–°–∫–∞—á–∞—Ç—å events.json" –∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –≤ GitHub</li>
      </ol>
    </div>
    
    <!-- –ü–æ–¥–≤–∞–ª -->
    <div style="text-align: center; padding: 30px; color: #64748b; font-size: 0.9rem; margin-top: 20px;">
      <p>–†–µ–¥–∞–∫—Ç–æ—Ä –∫–∞–ª–µ–Ω–¥–∞—Ä—è —Ñ—É—Ä—Ä–∏-—Å–æ–±—ã—Ç–∏–π 2026 | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ü–≤–µ—Ç–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π</p>
    </div>
  </div>

  <script>
    // ============ –ù–ê–°–¢–†–û–ô–ö–ò ============
    // –£–°–¢–ê–ù–û–í–ò–¢–ï –°–í–û–ô –ü–ê–†–û–õ–¨ –ó–î–ï–°–¨:
    const ADMIN_PASSWORD = "furry2026"; // ‚ö†Ô∏è –ó–ê–ú–ï–ù–ò–¢–ï –ù–ê –°–í–û–ô –ü–ê–†–û–õ–¨!
    
    // ============ –ö–ê–¢–ï–ì–û–†–ò–ò –ò –¶–í–ï–¢–ê ============
    const CATEGORY_COLORS = {
      'convention': '#3b82f6',  // –°–∏–Ω–∏–π
      'camping': '#10b981',     // –ó–µ–ª—ë–Ω—ã–π
      'meetup': '#f59e0b',      // –û—Ä–∞–Ω–∂–µ–≤—ã–π
      'tentative': '#6b7280'    // –°–µ—Ä—ã–π
    };
    
    const CATEGORY_NAMES = {
      'convention': '–ö–æ–Ω–≤–µ–Ω—Ç',
      'camping': '–ö–µ–º–ø–∏–Ω–≥',
      'meetup': '–ú–∞—Ä–∫–µ—Ç',
      'tentative': '–ü–æ–¥ –≤–æ–ø—Ä–æ—Å–æ–º'
    };
    
    // ============ –ü–ï–†–ï–ú–ï–ù–ù–´–ï ============
    let events = [];
    let tentativeEvents = [];
    let currentEditId = null;
    let isEditingTentative = false;
    let isManualColor = false; // –§–ª–∞–≥ —Ä—É—á–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–≤–µ—Ç–∞
    
    // ============ –ü–ê–†–û–õ–¨ –ò –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø ============
    function checkPassword() {
      const password = document.getElementById('password').value;
      if (password === ADMIN_PASSWORD) {
        localStorage.setItem('calendar_editor_auth', 'true');
        localStorage.setItem('calendar_editor_last_login', new Date().toISOString());
        document.getElementById('passwordScreen').style.display = 'none';
        document.getElementById('mainContent').style.display = 'block';
        loadEvents();
        updateStats();
      } else {
        const errorEl = document.getElementById('passwordError');
        errorEl.style.display = 'block';
        errorEl.style.animation = 'none';
        setTimeout(() => {
          errorEl.style.animation = 'shake 0.5s';
        }, 10);
      }
    }
    
    function togglePasswordVisibility() {
      const passwordInput = document.getElementById('password');
      const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
      passwordInput.setAttribute('type', type);
    }
    
    function logout() {
      if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏?')) {
        localStorage.removeItem('calendar_editor_auth');
        location.reload();
      }
    }
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    window.addEventListener('DOMContentLoaded', function() {
      if (localStorage.getItem('calendar_editor_auth') === 'true') {
        const lastLogin = localStorage.getItem('calendar_editor_last_login');
        const loginTime = new Date(lastLogin);
        const now = new Date();
        const hoursSinceLogin = (now - loginTime) / (1000 * 60 * 60);
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã—Ö–æ–¥ —á–µ—Ä–µ–∑ 8 —á–∞—Å–æ–≤
        if (hoursSinceLogin < 8) {
          document.getElementById('passwordScreen').style.display = 'none';
          document.getElementById('mainContent').style.display = 'block';
          initEditor();
        } else {
          localStorage.removeItem('calendar_editor_auth');
        }
      }
    });
    
    // ============ –£–¢–ò–õ–ò–¢–´ ============
    function showMessage(text, type = 'info') {
      const status = document.getElementById('statusMessage');
      status.textContent = text;
      status.className = `status ${type}`;
      status.style.display = 'block';
      setTimeout(() => { 
        status.style.display = 'none';
      }, 4000);
    }
    
    function updateStats() {
      const now = new Date();
      const upcoming = events.filter(e => new Date(e.startDate) >= now).length;
      
      document.getElementById('totalEvents').textContent = events.length;
      document.getElementById('upcomingEvents').textContent = upcoming;
      document.getElementById('tentativeCount').textContent = tentativeEvents.length;
      document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
    }
    
    // ============ –†–ê–ë–û–¢–ê –° –¶–í–ï–¢–ê–ú–ò ============
    function updateColorByCategory() {
      if (isManualColor) {
        // –ï—Å–ª–∏ —Ü–≤–µ—Ç –∏–∑–º–µ–Ω–µ–Ω –≤—Ä—É—á–Ω—É—é, –Ω–µ –º–µ–Ω—è–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
        updateColorHint();
        return;
      }
      
      const category = document.getElementById('category').value;
      const color = CATEGORY_COLORS[category] || '#3b82f6';
      const categoryName = CATEGORY_NAMES[category] || category;
      
      // –û–±–Ω–æ–≤–ª—è–µ–º —Ü–≤–µ—Ç
      document.getElementById('color').value = color;
      document.getElementById('colorPreview').style.backgroundColor = color;
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É
      updateColorHint();
      
      // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥ —Ä—É—á–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞ –¥–ª—è –Ω–æ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è
      if (!currentEditId) {
        isManualColor = false;
        document.getElementById('colorStatus').textContent = '(–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π)';
        document.getElementById('colorStatus').style.color = '#64748b';
      }
    }
    
    function manualColorChange() {
      isManualColor = true;
      const color = document.getElementById('color').value;
      document.getElementById('colorPreview').style.backgroundColor = color;
      document.getElementById('colorStatus').textContent = '(—Ä—É—á–Ω–æ–π)';
      document.getElementById('colorStatus').style.color = '#d946ef';
      updateColorHint();
    }
    
    function resetToAutoColor() {
      isManualColor = false;
      updateColorByCategory();
      document.getElementById('colorStatus').textContent = '(–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π)';
      document.getElementById('colorStatus').style.color = '#64748b';
      showMessage('–¶–≤–µ—Ç —Å–±—Ä–æ—à–µ–Ω –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏', 'info');
    }
    
    function updateColorHint() {
      const category = document.getElementById('category').value;
      const currentColor = document.getElementById('color').value;
      const defaultColor = CATEGORY_COLORS[category] || '#3b82f6';
      const categoryName = CATEGORY_NAMES[category] || category;
      
      document.getElementById('currentCategoryColor').style.backgroundColor = defaultColor;
      
      if (currentColor === defaultColor || !isManualColor) {
        document.getElementById('currentCategoryText').textContent = 
          `–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ü–≤–µ—Ç –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "${categoryName}"`;
      } else {
        document.getElementById('currentCategoryText').textContent = 
          `–†—É—á–Ω–æ–π —Ü–≤–µ—Ç (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–ª—è "${categoryName}" - ${defaultColor})`;
      }
    }
    
    // ============ –†–ê–ë–û–¢–ê –° –î–ê–ù–ù–´–ú–ò ============
    async function loadEvents() {
      try {
        const response = await fetch('events.json');
        if (!response.ok) throw new Error('–§–∞–π–ª events.json –Ω–µ –Ω–∞–π–¥–µ–Ω');
        
        const data = await response.json();
        events = data.events || [];
        tentativeEvents = data.tentativeEvents || [];
        
        renderEvents();
        renderTentativeEvents();
        updateStats();
        
        showMessage(`–ó–∞–≥—Ä—É–∂–µ–Ω–æ ${events.length} —Å–æ–±—ã—Ç–∏–π –∏ ${tentativeEvents.length} —Å–æ–±—ã—Ç–∏–π –ø–æ–¥ –≤–æ–ø—Ä–æ—Å–æ–º`, 'success');
        
      } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
        showMessage('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å events.json. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–∞.', 'error');
        events = [];
        tentativeEvents = [];
        renderEvents();
        renderTentativeEvents();
      }
    }
    
    function renderEvents() {
      const container = document.getElementById('eventsList');
      if (!container) return;
      
      // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–µ
      const sortedEvents = [...events].sort((a, b) => 
        new Date(a.startDate) - new Date(b.startDate)
      );
      
      // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
      const searchQuery = document.getElementById('searchEvents')?.value.toLowerCase() || '';
      const filterCategory = document.getElementById('filterCategory')?.value || '';
      
      const filteredEvents = sortedEvents.filter(event => {
        const matchesSearch = event.title.toLowerCase().includes(searchQuery) || 
                              (event.description || '').toLowerCase().includes(searchQuery) ||
                              (event.location || '').toLowerCase().includes(searchQuery);
        const matchesCategory = !filterCategory || event.category === filterCategory;
        return matchesSearch && matchesCategory;
      });
      
      if (filteredEvents.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            <p style="font-size: 1.1rem; margin-bottom: 10px;">–°–æ–±—ã—Ç–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
            <p style="color: #94a3b8;">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä</p>
          </div>
        `;
        return;
      }
      
      container.innerHTML = filteredEvents.map(event => {
        const startDate = new Date(event.startDate);
        const endDate = new Date(event.endDate);
        const isSingleDay = event.startDate === event.endDate;
        const now = new Date();
        const isPast = endDate < now;
        const isCurrent = startDate <= now && endDate >= now;
        
        const dateStr = isSingleDay 
          ? startDate.toLocaleDateString('ru-RU', { day: 'numeric', month: 'long' })
          : `${startDate.getDate()} ${getMonthName(startDate.getMonth())} ‚Äî ${endDate.getDate()} ${getMonthName(endDate.getMonth())}`;
        
        const categoryInfo = getCategoryInfo(event.category);
        
        return `
        <div class="event-item" data-id="${event.id}" style="border-left-color: ${event.color}; opacity: ${isPast ? '0.8' : '1'}">
          <div class="event-header">
            <div style="flex: 1;">
              <div class="event-title">${event.title} ${isCurrent ? 'üî¥' : ''}</div>
              <div class="event-dates">
                <span style="background: ${event.color}20; color: ${event.color}; padding: 4px 10px; border-radius: 20px; font-size: 0.8rem; font-weight: 600;">
                  ${categoryInfo.icon} ${categoryInfo.name}
                </span>
                <span style="color: ${isPast ? '#94a3b8' : '#0f172a'};">
                  üìÖ ${dateStr} ${event.startDate.substring(0, 4)}
                </span>
                ${event.location ? `<span>üìç ${event.location}</span>` : ''}
              </div>
            </div>
            <div class="event-actions">
              <button onclick="editEvent('${event.id}')" class="btn btn-secondary" style="padding: 10px 15px;">
                <span>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</span>
              </button>
              <button onclick="deleteEvent('${event.id}')" class="btn btn-danger" style="padding: 10px 15px;">
                <span>üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</span>
              </button>
            </div>
          </div>
          ${event.description ? `<p style="color: #475569; line-height: 1.5; margin-bottom: 10px;">${event.description}</p>` : ''}
          ${event.url ? `<a href="${event.url}" target="_blank" style="color: ${event.color}; text-decoration: none; font-weight: 500;">üîó ${event.url.replace('https://', '').replace('http://', '')}</a>` : ''}
        </div>
      `;
      }).join('');
      
      // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø–æ–∏—Å–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
      const searchInput = document.getElementById('searchEvents');
      const filterSelect = document.getElementById('filterCategory');
      
      if (searchInput) {
        searchInput.addEventListener('input', renderEvents);
      }
      if (filterSelect) {
        filterSelect.addEventListener('change', renderEvents);
      }
    }
    
    function renderTentativeEvents() {
      const container = document.getElementById('tentativeEventsList');
      if (!container) return;
      
      if (tentativeEvents.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            <p style="font-size: 1.1rem; margin-bottom: 10px;">–ù–µ—Ç —Å–æ–±—ã—Ç–∏–π –ø–æ–¥ –≤–æ–ø—Ä–æ—Å–æ–º</p>
          </div>
        `;
        return;
      }
      
      container.innerHTML = tentativeEvents.map(event => {
        const categoryInfo = getCategoryInfo(event.category);
        
        return `
        <div class="event-item" data-id="${event.id}" style="border-left-color: #f59e0b;">
          <div class="event-header">
            <div style="flex: 1;">
              <div class="event-title">${event.title}</div>
              <div class="event-dates">
                <span style="background: #f59e0b20; color: #f59e0b; padding: 4px 10px; border-radius: 20px; font-size: 0.8rem; font-weight: 600;">
                  ‚ùì ${categoryInfo.name}
                </span>
                <span>üìÖ ${event.estimatedDate}</span>
                ${event.location ? `<span>üìç ${event.location}</span>` : ''}
              </div>
            </div>
            <div class="event-actions">
              <button onclick="editTentativeEvent('${event.id}')" class="btn btn-primary" style="padding: 10px 15px;">
                <span>‚úÖ –£–∫–∞–∑–∞—Ç—å –¥–∞—Ç—ã</span>
              </button>
              <button onclick="deleteTentativeEvent('${event.id}')" class="btn btn-danger" style="padding: 10px 15px;">
                <span>üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</span>
              </button>
            </div>
          </div>
          ${event.description ? `<p style="color: #475569; line-height: 1.5; margin-bottom: 10px;">${event.description}</p>` : ''}
          ${event.url ? `<a href="${event.url}" target="_blank" style="color: #f59e0b; text-decoration: none; font-weight: 500;">üîó ${event.url.replace('https://', '').replace('http://', '')}</a>` : ''}
        </div>
      `;
      }).join('');
    }
    
    function getCategoryInfo(categoryId) {
      const categories = {
        'convention': { name: '–ö–æ–Ω–≤–µ–Ω—Ç', icon: 'üé™', color: '#3b82f6' },
        'camping': { name: '–ö–µ–º–ø–∏–Ω–≥', icon: 'üèïÔ∏è', color: '#10b981' },
        'meetup': { name: '–ú–∞—Ä–∫–µ—Ç', icon: 'üõçÔ∏è', color: '#f59e0b' },
        'tentative': { name: '–ü–æ–¥ –≤–æ–ø—Ä–æ—Å–æ–º', icon: '‚ùì', color: '#6b7280' }
      };
      return categories[categoryId] || { name: categoryId, icon: 'üìÖ', color: '#6b7280' };
    }
    
    function getMonthName(monthIndex) {
      const months = ['—è–Ω–≤–∞—Ä—è', '—Ñ–µ–≤—Ä–∞–ª—è', '–º–∞—Ä—Ç–∞', '–∞–ø—Ä–µ–ª—è', '–º–∞—è', '–∏—é–Ω—è', '–∏—é–ª—è', '–∞–≤–≥—É—Å—Ç–∞', '—Å–µ–Ω—Ç—è–±—Ä—è', '–æ–∫—Ç—è–±—Ä—è', '–Ω–æ—è–±—Ä—è', '–¥–µ–∫–∞–±—Ä—è'];
      return months[monthIndex];
    }
    
    // ============ –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–ï –°–û–ë–´–¢–ò–ô ============
    function editEvent(id) {
      const event = events.find(e => e.id === id);
      if (!event) return;
      
      currentEditId = id;
      isEditingTentative = false;
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–æ–≤–ø–∞–¥–∞–µ—Ç –ª–∏ —Ü–≤–µ—Ç —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
      const defaultColor = CATEGORY_COLORS[event.category];
      isManualColor = event.color !== defaultColor;
      
      document.getElementById('formTitle').textContent = '‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ';
      
      // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É
      document.getElementById('eventId').value = event.id;
      document.getElementById('eventTitle').value = event.title;
      document.getElementById('startDate').value = event.startDate;
      document.getElementById('endDate').value = event.endDate;
      document.getElementById('category').value = event.category;
      document.getElementById('color').value = event.color;
      document.getElementById('colorPreview').style.backgroundColor = event.color;
      document.getElementById('location').value = event.location || '';
      document.getElementById('url').value = event.url || '';
      document.getElementById('description').value = event.description || '';
      
      // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å —Ü–≤–µ—Ç–∞
      if (isManualColor) {
        document.getElementById('colorStatus').textContent = '(—Ä—É—á–Ω–æ–π)';
        document.getElementById('colorStatus').style.color = '#d946ef';
      } else {
        document.getElementById('colorStatus').textContent = '(–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π)';
        document.getElementById('colorStatus').style.color = '#64748b';
      }
      
      updateColorHint();
      
      // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ —Ñ–æ—Ä–º–µ
      document.querySelector('.card').scrollIntoView({ behavior: 'smooth', block: 'start' });
      showMessage('–†–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Å–æ–±—ã—Ç–∏–µ –∏ –Ω–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ"', 'info');
    }
    
    function editTentativeEvent(id) {
      const event = tentativeEvents.find(e => e.id === id);
      if (!event) return;
      
      currentEditId = id;
      isEditingTentative = true;
      isManualColor = false;
      
      document.getElementById('formTitle').textContent = '‚úÖ –£–∫–∞–∑–∞—Ç—å –¥–∞—Ç—ã –¥–ª—è —Å–æ–±—ã—Ç–∏—è';
      
      // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É
      document.getElementById('eventId').value = event.id;
      document.getElementById('eventTitle').value = event.title;
      document.getElementById('startDate').value = '2026-01-01';
      document.getElementById('endDate').value = '2026-01-01';
      document.getElementById('category').value = event.category === 'tentative' ? 'meetup' : event.category;
      
      const defaultColor = CATEGORY_COLORS[event.category === 'tentative' ? 'meetup' : event.category] || '#3b82f6';
      document.getElementById('color').value = defaultColor;
      document.getElementById('colorPreview').style.backgroundColor = defaultColor;
      document.getElementById('location').value = event.location || '';
      document.getElementById('url').value = event.url || '';
      document.getElementById('description').value = event.description || '';
      
      document.getElementById('colorStatus').textContent = '(–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π)';
      document.getElementById('colorStatus').style.color = '#64748b';
      updateColorHint();
      
      document.querySelector('.card').scrollIntoView({ behavior: 'smooth', block: 'start' });
      showMessage('–£–∫–∞–∂–∏—Ç–µ —Ç–æ—á–Ω—ã–µ –¥–∞—Ç—ã –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å', 'info');
    }
    
    function saveEvent() {
      // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–æ—Ä–º—ã
      const id = document.getElementById('eventId').value.trim();
      const title = document.getElementById('eventTitle').value.trim();
      const startDate = document.getElementById('startDate').value;
      const endDate = document.getElementById('endDate').value;
      const category = document.getElementById('category').value;
      const color = document.getElementById('color').value;
      const location = document.getElementById('location').value.trim();
      const url = document.getElementById('url').value.trim();
      const description = document.getElementById('description').value.trim();
      
      // –ü—Ä–æ–≤–µ—Ä–∫–∏
      if (!id || !title || !startDate || !endDate || !category) {
        showMessage('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'error');
        return;
      }
      
      if (startDate > endDate) {
        showMessage('–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–∑–∂–µ –¥–∞—Ç—ã –æ–∫–æ–Ω—á–∞–Ω–∏—è', 'error');
        return;
      }
      
      if (!/^[a-z0-9\-]+$/.test(id)) {
        showMessage('ID –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –ª–∞—Ç–∏–Ω—Å–∫–∏–µ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã –∏ –¥–µ—Ñ–∏—Å—ã', 'error');
        return;
      }
      
      const eventData = {
        id,
        title,
        startDate,
        endDate,
        color,
        category,
        location: location || '',
        description: description || '',
        url: url || ''
      };
      
      if (currentEditId) {
        // –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ
        if (isEditingTentative) {
          // –ü–µ—Ä–µ–º–µ—â–∞–µ–º –∏–∑ tentative –≤ –æ—Å–Ω–æ–≤–Ω—ã–µ
          const index = tentativeEvents.findIndex(e => e.id === currentEditId);
          if (index !== -1) {
            tentativeEvents.splice(index, 1);
          }
          events.push(eventData);
          showMessage('–°–æ–±—ã—Ç–∏–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–æ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å', 'success');
        } else {
          // –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º –æ—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ
          const index = events.findIndex(e => e.id === currentEditId);
          if (index !== -1) {
            events[index] = eventData;
            showMessage('–°–æ–±—ã—Ç–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–æ', 'success');
          } else {
            events.push(eventData);
            showMessage('–°–æ–∑–¥–∞–Ω–æ –Ω–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ', 'success');
          }
        }
      } else {
        // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ
        events.push(eventData);
        showMessage('–°–æ–±—ã—Ç–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ', 'success');
      }
      
      // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É –∏ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º
      clearForm();
      renderEvents();
      renderTentativeEvents();
      updateStats();
    }
    
    function deleteEvent(id) {
      if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ —Å–æ–±—ã—Ç–∏–µ? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) return;
      
      events = events.filter(e => e.id !== id);
      renderEvents();
      updateStats();
      showMessage('–°–æ–±—ã—Ç–∏–µ —É–¥–∞–ª–µ–Ω–æ', 'success');
    }
    
    function deleteTentativeEvent(id) {
      if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ —Å–æ–±—ã—Ç–∏–µ? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) return;
      
      tentativeEvents = tentativeEvents.filter(e => e.id !== id);
      renderTentativeEvents();
      updateStats();
      showMessage('–°–æ–±—ã—Ç–∏–µ —É–¥–∞–ª–µ–Ω–æ', 'success');
    }
    
    function clearForm() {
      currentEditId = null;
      isEditingTentative = false;
      isManualColor = false;
      document.getElementById('formTitle').textContent = '‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ';
      document.getElementById('eventId').value = '';
      document.getElementById('eventTitle').value = '';
      document.getElementById('startDate').value = '2026-01-01';
      document.getElementById('endDate').value = '2026-01-01';
      document.getElementById('category').value = 'convention';
      document.getElementById('color').value = '#3b82f6';
      document.getElementById('colorPreview').style.backgroundColor = '#3b82f6';
      document.getElementById('location').value = '';
      document.getElementById('url').value = '';
      document.getElementById('description').value = '';
      document.getElementById('colorStatus').textContent = '(–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π)';
      document.getElementById('colorStatus').style.color = '#64748b';
      updateColorHint();
    }
    
    function addSampleEvent() {
      const sampleId = 'sample-' + Date.now().toString().slice(-6);
      const sampleDate = new Date(2026, Math.floor(Math.random() * 12), Math.floor(Math.random() * 28) + 1);
      const formattedDate = sampleDate.toISOString().split('T')[0];
      
      document.getElementById('eventId').value = sampleId;
      document.getElementById('eventTitle').value = '–ü—Ä–∏–º–µ—Ä —Å–æ–±—ã—Ç–∏—è';
      document.getElementById('startDate').value = formattedDate;
      document.getElementById('endDate').value = formattedDate;
      document.getElementById('category').value = 'meetup';
      document.getElementById('color').value = '#f59e0b';
      document.getElementById('colorPreview').style.backgroundColor = '#f59e0b';
      document.getElementById('location').value = '–ú–æ—Å–∫–≤–∞';
      document.getElementById('url').value = 'https://t.me/example';
      document.getElementById('description').value = '–≠—Ç–æ –ø—Ä–∏–º–µ—Ä —Å–æ–±—ã—Ç–∏—è. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ.';
      
      isManualColor = false;
      document.getElementById('colorStatus').textContent = '(–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π)';
      document.getElementById('colorStatus').style.color = '#64748b';
      updateColorHint();
      
      showMessage('–ó–∞–ø–æ–ª–Ω–µ–Ω–∞ —Ñ–æ—Ä–º–∞ –ø—Ä–∏–º–µ—Ä–∞. –ò–∑–º–µ–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.', 'info');
    }
    
    // ============ –°–û–•–†–ê–ù–ï–ù–ò–ï –í –§–ê–ô–õ ============
    function saveToFile() {
      const categories = [
        { "id": "convention", "name": "–ö–æ–Ω–≤–µ–Ω—Ç—ã", "color": "#3b82f6" },
        { "id": "camping", "name": "–ö–µ–º–ø–∏–Ω–≥–∏", "color": "#10b981" },
        { "id": "meetup", "name": "–ú–∞—Ä–∫–µ—Ç—ã", "color": "#f59e0b" },
        { "id": "tentative", "name": "–ü–æ–¥ –≤–æ–ø—Ä–æ—Å–æ–º", "color": "#6b7280" }
      ];
      
      const data = {
        events: events,
        categories: categories,
        tentativeEvents: tentativeEvents
      };
      
      const jsonString = JSON.stringify(data, null, 2);
      
      // –°–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
      const blob = new Blob([jsonString], { type: 'application/json;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'events.json';
      
      // –î–æ–±–∞–≤–ª—è–µ–º –¥–∞—Ç—É –≤ –∏–º—è —Ñ–∞–π–ª–∞
      const now = new Date();
      const dateStr = now.toISOString().slice(0, 10).replace(/-/g, '');
      a.download = `events-${dateStr}.json`;
      
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
      
      showMessage(`–§–∞–π–ª events.json —Å–∫–∞—á–∞–Ω! –ó–∞–≥—Ä—É–∑–∏—Ç–µ –µ–≥–æ –Ω–∞ GitHub.`, 'success');
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é
      setTimeout(() => {
        alert(
          '‚úÖ –§–∞–π–ª —É—Å–ø–µ—à–Ω–æ —Å–∫–∞—á–∞–Ω!\n\n' +
          'üì• –ß—Ç–æ–±—ã –æ–±–Ω–æ–≤–∏—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å –Ω–∞ —Å–∞–π—Ç–µ:\n\n' +
          '1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ GitHub.com\n' +
          '2. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π\n' +
          '3. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Ñ–∞–π–ª events.json\n' +
          '4. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É ‚úèÔ∏è Edit (–∫–∞—Ä–∞–Ω–¥–∞—à)\n' +
          '5. –£–î–ê–õ–ò–¢–ï –í–ï–°–¨ —Å—Ç–∞—Ä—ã–π —Ç–µ–∫—Å—Ç\n' +
          '6. –í–°–¢–ê–í–¨–¢–ï –Ω–æ–≤—ã–π JSON –∏–∑ —Å–∫–∞—á–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞\n' +
          '7. –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –≤–Ω–∏–∑ –∏ –Ω–∞–∂–º–∏—Ç–µ Commit changes\n\n' +
          'üåê –°–∞–π—Ç –æ–±–Ω–æ–≤–∏—Ç—Å—è —á–µ—Ä–µ–∑ 1-2 –º–∏–Ω—É—Ç—ã!'
        );
      }, 300);
    }
    
    // ============ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ============
    function initEditor() {
      loadEvents();
      
      // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–µ–≤—å—é —Ü–≤–µ—Ç–∞
      const colorInput = document.getElementById('color');
      const colorPreview = document.getElementById('colorPreview');
      
      if (colorInput && colorPreview) {
        colorPreview.style.backgroundColor = colorInput.value;
        colorInput.addEventListener('input', manualColorChange);
      }
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É —Ü–≤–µ—Ç–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
      document.getElementById('category').addEventListener('change', updateColorHint);
      
      // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
      setInterval(() => {
        if (events.length > 0) {
          localStorage.setItem('calendar_editor_backup', JSON.stringify({
            events,
            tentativeEvents,
            timestamp: new Date().toISOString()
          }));
        }
      }, 5 * 60 * 1000);
    }
    
    // –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∏–º–∞—Ü–∏—é —Ç—Ä—è—Å–∫–∏ –¥–ª—è –æ—à–∏–±–æ–∫
    const style = document.createElement('style');
    style.textContent = `
      @keyframes shake {
        0%, 100% { transform: translateX(0); }
        10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
        20%, 40%, 60%, 80% { transform: translateX(5px); }
      }
    `;
    document.head.appendChild(style);
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    window.addEventListener('DOMContentLoaded', function() {
      if (localStorage.getItem('calendar_editor_auth') === 'true') {
        initEditor();
      }
    });
  </script>
</body>
</html>