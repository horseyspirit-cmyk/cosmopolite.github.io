<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Furry Events 2026</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <style>
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }
        .month-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
        }
        .day-cell {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            cursor: default;
            position: relative;
        }
        .day-cell.has-event {
            cursor: pointer;
            color: white;
            font-weight: bold;
            border-radius: 9999px;
        }
        .day-cell.has-event:hover {
            opacity: 0.8;
            transform: scale(1.1);
            transition: all 0.2s;
            z-index: 10;
        }
        /* Modal transition */
        .modal {
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal.active {
            opacity: 1;
            visibility: visible;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 font-sans min-h-screen">

    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-20">
        <div class="container mx-auto px-4 py-4 flex flex-col md:flex-row justify-between items-center">
            <h1 class="text-2xl font-bold text-slate-800 flex items-center gap-2">
                <span>üìÖ</span> Furry Events 2026
            </h1>
            <div id="legend" class="flex flex-wrap gap-3 mt-3 md:mt-0 text-sm">
                <!-- Legend items injected here -->
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8">
        
        <!-- Stats / Quick Links -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                <h3 class="text-lg font-semibold mb-2">–í—Å–µ–≥–æ —Å–æ–±—ã—Ç–∏–π</h3>
                <p class="text-3xl font-bold text-blue-600" id="total-events-count">0</p>
                <p class="text-sm text-slate-500 mt-1">–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ 2026</p>
            </div>
            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                <h3 class="text-lg font-semibold mb-2">–ë–ª–∏–∂–∞–π—à–µ–µ</h3>
                <div id="next-event-widget">
                    <p class="text-slate-400">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                </div>
            </div>
             <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 flex flex-col justify-center">
                <a href="#tentative-section" class="text-blue-600 hover:text-blue-800 font-medium flex items-center gap-2 transition-colors">
                    –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–æ–±—ã—Ç–∏—è –ø–æ–¥ –≤–æ–ø—Ä–æ—Å–æ–º &darr;
                </a>
            </div>
        </div>

        <!-- Calendar Year View -->
        <h2 class="text-xl font-bold mb-6 border-l-4 border-blue-500 pl-3">–ö–∞–ª–µ–Ω–¥–∞—Ä—å 2026</h2>
        <div id="calendar-container" class="calendar-grid mb-12">
            <!-- Months injected here -->
        </div>

        <!-- Tentative Events -->
        <div id="tentative-section" class="mb-12">
            <h2 class="text-xl font-bold mb-6 border-l-4 border-slate-400 pl-3">–°–æ–±—ã—Ç–∏—è –ø–æ–¥ –≤–æ–ø—Ä–æ—Å–æ–º</h2>
            <div id="tentative-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <!-- Tentative events injected here -->
            </div>
        </div>

    </main>

    <footer class="bg-slate-800 text-slate-300 py-8 text-center text-sm">
        <p>&copy; 2026 Furry Events Calendar. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å—Å—è.</p>
    </footer>

    <!-- Event Detail Modal -->
    <div id="event-modal" class="modal fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4">
        <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full overflow-hidden transform transition-all scale-100">
            <div class="relative h-24 bg-blue-600" id="modal-header-bg">
                <button id="close-modal" class="absolute top-4 right-4 bg-black/20 hover:bg-black/40 text-white rounded-full p-1 w-8 h-8 flex items-center justify-center transition-colors">
                    &times;
                </button>
            </div>
            <div class="px-6 pb-6 -mt-10 relative">
                <div class="bg-white rounded-xl p-4 shadow-sm border border-slate-100 mb-4 flex items-center gap-3">
                    <div id="modal-date-badge" class="bg-blue-100 text-blue-700 font-bold px-3 py-1 rounded text-sm text-center min-w-[60px]">
                        JAN<br>05
                    </div>
                    <div>
                        <h3 id="modal-title" class="text-xl font-bold text-slate-900 leading-tight">Event Title</h3>
                        <p id="modal-category" class="text-sm text-slate-500">Category</p>
                    </div>
                </div>
                
                <div class="space-y-4">
                    <div class="flex items-start gap-3">
                        <span class="text-slate-400 mt-0.5">üìÖ</span>
                        <div>
                            <p class="text-sm font-semibold text-slate-700">–î–∞—Ç—ã –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è</p>
                            <p id="modal-dates" class="text-sm text-slate-600">Start - End</p>
                        </div>
                    </div>
                    
                    <div class="flex items-start gap-3" id="modal-location-container">
                        <span class="text-slate-400 mt-0.5">üìç</span>
                        <div>
                            <p class="text-sm font-semibold text-slate-700">–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ</p>
                            <p id="modal-location" class="text-sm text-slate-600">Location</p>
                        </div>
                    </div>

                    <div class="flex items-start gap-3">
                        <span class="text-slate-400 mt-0.5">üìù</span>
                        <div>
                            <p class="text-sm font-semibold text-slate-700">–û–ø–∏—Å–∞–Ω–∏–µ</p>
                            <p id="modal-description" class="text-sm text-slate-600 leading-relaxed">Description goes here.</p>
                        </div>
                    </div>
                </div>

                <div class="mt-6 pt-4 border-t border-slate-100 flex justify-end">
                    <a id="modal-link" href="#" target="_blank" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2">
                        –ü–æ–¥—Ä–æ–±–Ω–µ–µ <span>&rarr;</span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data from JSON
        const appData = {
          "events": [
            {
              "id": "wintertails-2026-01",
              "title": "–í–∏–Ω—Ç–µ—Ä—Ç–µ–π–ª–∑",
              "startDate": "2026-01-05",
              "endDate": "2026-01-08",
              "color": "#3b82f6",
              "category": "convention",
              "location": "",
              "description": "–ó–∏–º–Ω–∏–π —Ñ—É—Ä—Ä–∏-–∫–æ–Ω–≤–µ–Ω—Ç.",
              "url": ""
            },
            {
              "id": "dikiy-market-2026-02",
              "title": "–î–ò–ö–ò–ô –º–∞—Ä–∫–µ—Ç",
              "startDate": "2026-02-21",
              "endDate": "2026-02-21",
              "color": "#f59e0b",
              "category": "meetup",
              "location": "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",
              "description": "–î–ò–ö–ò–ô –º–∞—Ä–∫–µ—Ç ‚Äî —Ñ—É—Ä—Ä–∏-–º–∞—Ä–∫–µ—Ç –≤ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–µ.",
              "url": "https://vk.com/dikiy_market"
            },
            {
              "id": "furmarket-2026-03",
              "title": "–§—É—Ä–º–∞—Ä–∫–µ—Ç",
              "startDate": "2026-03-22",
              "endDate": "2026-03-22",
              "color": "#f59e0b",
              "category": "meetup",
              "location": "",
              "description": "–§—É—Ä—Ä–∏-–º–∞—Ä–∫–µ—Ç ‚Äî —è—Ä–º–∞—Ä–∫–∞ —Ñ—É—Ä—Ä–∏-—Ç–æ–≤–∞—Ä–æ–≤, –∞—Ä—Ç–∞ –∏ merchandise.",
              "url": "https://vk.com/furrmarket"
            },
            {
              "id": "camping-2026-05-01",
              "title": "–ö–µ–º–ø–∏–Ω–≥",
              "startDate": "2026-05-01",
              "endDate": "2026-05-04",
              "color": "#10b981",
              "category": "camping",
              "location": "",
              "description": "–ú–∞–π—Å–∫–∏–π –∫–µ–º–ø–∏–Ω–≥ –Ω–∞ –ø—Ä–∏—Ä–æ–¥–µ.",
              "url": ""
            },
            {
              "id": "bbfc-2026-05",
              "title": "BBFC",
              "startDate": "2026-05-08",
              "endDate": "2026-05-11",
              "color": "#3b82f6",
              "category": "convention",
              "location": "",
              "description": "Big Blue Furry Convention.",
              "url": "https://t.me/joinchat/BH_Bp0jaxHx7SmaaoKwIaQ"
            },
            {
              "id": "foxwood-2026-05",
              "title": "FoxWood",
              "startDate": "2026-05-14",
              "endDate": "2026-05-17",
              "color": "#3b82f6",
              "category": "convention",
              "location": "",
              "description": "FoxWood ‚Äî –ª–µ—Å–Ω–æ–π —Ñ—É—Ä—Ä–∏-–∫–æ–Ω–≤–µ–Ω—Ç.",
              "url": "https://t.me/foxwoodnews"
            },
            {
              "id": "camping-2026-06-12",
              "title": "–ö–µ–º–ø–∏–Ω–≥",
              "startDate": "2026-06-12",
              "endDate": "2026-06-15",
              "color": "#10b981",
              "category": "camping",
              "location": "",
              "description": "–ò—é–Ω—å—Å–∫–∏–π –∫–µ–º–ø–∏–Ω–≥.",
              "url": ""
            },
            {
              "id": "gp-2026-06",
              "title": "–ì–ü",
              "startDate": "2026-06-26",
              "endDate": "2026-06-28",
              "color": "#8b5cf6",
              "category": "convention",
              "location": "",
              "description": "–ì–ü ‚Äî —Ñ—É—Ä—Ä–∏-–º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ.",
              "url": ""
            },
            {
              "id": "volkistan-2026-06",
              "title": "–í–æ–ª–∫–∏—Å—Ç–∞–Ω",
              "startDate": "2026-06-27",
              "endDate": "2026-06-29",
              "color": "#3b82f6",
              "category": "convention",
              "location": "",
              "description": "–í–æ–ª–∫–∏—Å—Ç–∞–Ω ‚Äî —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ñ—É—Ä—Ä–∏-–∫–æ–Ω–≤–µ–Ω—Ç.",
              "url": "https://t.me/wolkistan"
            },
            {
              "id": "wildfurrence-2026-07",
              "title": "WildFurence 26",
              "startDate": "2026-07-16",
              "endDate": "2026-07-19",
              "color": "#3b82f6",
              "category": "convention",
              "location": "–õ–∞–¥–æ–≥–∞",
              "description": "–ö–æ–Ω –Ω–∞ –õ–∞–¥–æ–≥–µ",
              "url": "https://t.me/wfinfo"
            },
            {
              "id": "camping-2026-07-19",
              "title": "–ö–µ–º–ø–∏–Ω–≥",
              "startDate": "2026-07-19",
              "endDate": "2026-07-20",
              "color": "#10b981",
              "category": "camping",
              "location": "",
              "description": "–ò—é–ª—å—Å–∫–∏–π –∫–µ–º–ø–∏–Ω–≥.",
              "url": ""
            },
            {
              "id": "turfur-2026-08",
              "title": "–¢—É—Ä—Ñ—É—Ä",
              "startDate": "2026-08-06",
              "endDate": "2026-08-09",
              "color": "#3b82f6",
              "category": "convention",
              "location": "",
              "description": "–¢—É—Ä—Ñ—É—Ä ‚Äî —Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π —Ñ—É—Ä—Ä–∏-–∫–æ–Ω–≤–µ–Ω—Ç.",
              "url": ""
            },
            {
              "id": "camping-2026-08-29",
              "title": "–ö–µ–º–ø–∏–Ω–≥",
              "startDate": "2026-08-29",
              "endDate": "2026-08-31",
              "color": "#10b981",
              "category": "camping",
              "location": "",
              "description": "–ê–≤–≥—É—Å—Ç–æ–≤—Å–∫–∏–π –∫–µ–º–ø–∏–Ω–≥ ‚Äî –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ª–µ—Ç–∞.",
              "url": ""
            },
            {
              "id": "tupikon-2026-09",
              "title": "–¢—É–ø–∏–∫–æ–Ω",
              "startDate": "2026-09-10",
              "endDate": "2026-09-13",
              "color": "#3b82f6",
              "category": "convention",
              "location": "",
              "description": "–¢—É–ø–∏–∫–æ–Ω ‚Äî –æ—Å–µ–Ω–Ω–∏–π —Ñ—É—Ä—Ä–∏-–∫–æ–Ω–≤–µ–Ω—Ç.",
              "url": "https://t.me/SillyConNews"
            },
            {
              "id": "epiccon-spb-2026-05",
              "title": "Epic Con –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",
              "startDate": "2026-05-30",
              "endDate": "2026-05-31",
              "color": "#3b82f6",
              "category": "convention",
              "location": "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",
              "description": "Epic Con ‚Äì –º–∞—Å—à—Ç–∞–±–Ω—ã–π —Ñ–µ—Å—Ç–∏–≤–∞–ª—å —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∏, –∫–∏–Ω–æ, —Å–µ—Ä–∏–∞–ª–æ–≤ –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã—Ö –∏–≥—Ä. –ü–æ–ª–Ω–æ–µ –ø–æ–≥—Ä—É–∂–µ–Ω–∏–µ –≤ —Ñ–∞–Ω—Ç–∞—Å—Ç–∏—á–µ—Å–∫–∏–π –º–∏—Ä.",
              "url": "https://epiccon.ru/"
            },
            {
              "id": "epiccon-msk-2026-07",
              "title": "Epic Con –ú–æ—Å–∫–≤–∞",
              "startDate": "2026-07-04",
              "endDate": "2026-07-05",
              "color": "#3b82f6",
              "category": "convention",
              "location": "–ú–æ—Å–∫–≤–∞",
              "description": "Epic Con ‚Äì –º–∞—Å—à—Ç–∞–±–Ω—ã–π —Ñ–µ—Å—Ç–∏–≤–∞–ª—å —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∏, –∫–∏–Ω–æ, —Å–µ—Ä–∏–∞–ª–æ–≤ –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã—Ö –∏–≥—Ä. –ü–æ–ª–Ω–æ–µ –ø–æ–≥—Ä—É–∂–µ–Ω–∏–µ –≤ —Ñ–∞–Ω—Ç–∞—Å—Ç–∏—á–µ—Å–∫–∏–π –º–∏—Ä.",
              "url": "https://epiccon.ru/"
            },
            {
              "id": "furrburgfest-2026-05",
              "title": "–§—É—Ä—Ä–±—É—Ä–≥–§–µ—Å—Ç 5.0",
              "startDate": "2026-05-03",
              "endDate": "2026-05-03",
              "color": "#f59e0b",
              "category": "meetup",
              "location": "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",
              "description": "–§—É—Ä—Ä–∏-–º–∞—Ä–∫–µ—Ç –≤ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–µ.",
              "url": "https://vk.com/fbfests"
            }
          ],
          "categories": [
            { "id": "convention", "name": "–ö–æ–Ω–≤–µ–Ω—Ç—ã", "color": "#3b82f6" },
            { "id": "camping", "name": "–ö–µ–º–ø–∏–Ω–≥–∏", "color": "#10b981" },
            { "id": "meetup", "name": "–ú–∞—Ä–∫–µ—Ç—ã", "color": "#f59e0b" },
            { "id": "tentative", "name": "–ü–æ–¥ –≤–æ–ø—Ä–æ—Å–æ–º", "color": "#6b7280" }
          ],
          "tentativeEvents": [
            {
              "id": "tent-i-luv-it-2026",
              "title": "i luv it –º–∞—Ä–∫–µ—Ç",
              "estimatedDate": "–î–∞—Ç–∞ —É—Ç–æ—á–Ω—è–µ—Ç—Å—è",
              "color": "#6b7280",
              "category": "meetup",
              "location": "",
              "description": "i luv it –º–∞—Ä–∫–µ—Ç ‚Äî –¥–∞—Ç–∞ —É—Ç–æ—á–Ω—è–µ—Ç—Å—è",
              "url": "https://vk.com/event230253960"
            },
            {
              "id": "tent-totem-stolb-2026",
              "title": "–ò–≤–µ–Ω—Ç—ã –æ—Ç \"–¢–æ—Ç–µ–º–Ω–æ–≥–æ —Å—Ç–æ–ª–±–∞\"",
              "estimatedDate": "–î–∞—Ç–∞ —É—Ç–æ—á–Ω—è–µ—Ç—Å—è",
              "color": "#6b7280",
              "category": "meetup",
              "location": "",
              "description": "–ò–≤–µ–Ω—Ç—ã –æ—Ç \"–¢–æ—Ç–µ–º–Ω–æ–≥–æ —Å—Ç–æ–ª–±–∞\" ‚Äî –¥–∞—Ç—ã —É—Ç–æ—á–Ω—è—é—Ç—Å—è",
              "url": "https://vk.com/event205940695"
            },
            {
              "id": "tent-fall-camping-2026",
              "title": "–û—Å–µ–Ω–Ω–∏–π –∫–µ–º–ø–∏–Ω–≥",
              "estimatedDate": "–û–∫—Ç—è–±—Ä—å 2026",
              "color": "#6b7280",
              "category": "camping",
              "location": "",
              "description": "–û—Å–µ–Ω–Ω–∏–π –∫–µ–º–ø–∏–Ω–≥ ‚Äî —Ç–æ—á–Ω—ã–µ –¥–∞—Ç—ã —É—Ç–æ—á–Ω—è—é—Ç—Å—è",
              "url": ""
            },
            {
              "id": "tent-furmarket-autumn-2026",
              "title": "–§—É—Ä–ú–∞—Ä–∫–µ—Ç –û—Å–µ–Ω–Ω–∏–π",
              "estimatedDate": "–ù–æ—è–±—Ä—å 2026",
              "color": "#6b7280",
              "category": "meetup",
              "location": "",
              "description": "–û—Å–µ–Ω–Ω–∏–π –º–∞—Ä–∫–µ—Ç ‚Äî –¥–∞—Ç–∞ —É—Ç–æ—á–Ω—è–µ—Ç—Å—è",
              "url": "https://vk.com/furrmarket"
            },
            {
              "id": "tent-winter-con-2026",
              "title": "–ó–∏–º–Ω–∏–π –∫–æ–Ω",
              "estimatedDate": "–î–µ–∫–∞–±—Ä—å 2026",
              "color": "#6b7280",
              "category": "convention",
              "location": "",
              "description": "–ó–∏–º–Ω–∏–π —Ñ—É—Ä—Ä–∏ –∫–æ–Ω–≤–µ–Ω—Ç ‚Äî –¥–∞—Ç—ã –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–µ",
              "url": ""
            },
            {
              "id": "tent-new-outdoor-2026",
              "title": "–ù–æ–≤—ã–π –∫–æ–Ω –Ω–∞ –ø—Ä–∏—Ä–æ–¥–µ",
              "estimatedDate": "–î–∞—Ç–∞ —É—Ç–æ—á–Ω—è–µ—Ç—Å—è",
              "color": "#6b7280",
              "category": "convention",
              "location": "",
              "description": "–ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –Ω–æ–≤—ã–π –∫–æ–Ω –Ω–∞ –ø—Ä–∏—Ä–æ–¥–µ, –¥–∞—Ç—ã –±—É–¥—É—Ç –æ–±—ä—è–≤–ª–µ–Ω—ã –ø–æ–∑–∂–µ",
              "url": ""
            },
            {
              "id": "tent-anyfurry-2026",
              "title": "AnyFurry Fest VII",
              "estimatedDate": "–ö–æ–Ω–µ—Ü 2026",
              "color": "#f59e0b",
              "category": "meetup",
              "location": "–ú–æ—Å–∫–≤–∞",
              "description": "–§—É—Ä—Ä–∏-–º–∞—Ä–∫–µ—Ç. –î–∞—Ç–∞ —É—Ç–æ—á–Ω—è–µ—Ç—Å—è.",
              "url": "https://vk.com/anyfurryfest"
            },
            {
              "id": "tent-dracon-2026",
              "title": "DraCon V",
              "estimatedDate": "5 –¥–µ–∫–∞–±—Ä—è 2026 (?)",
              "color": "#f59e0b",
              "category": "meetup",
              "location": "–ú–æ—Å–∫–≤–∞",
              "description": "–í–µ—Ä–æ—è—Ç–Ω–µ–µ –≤—Å–µ–≥–æ 5 –¥–µ–∫–∞–±—Ä—è.",
              "url": "https://vk.com/dracon"
            },
            {
              "id": "tent-kaifur-2026",
              "title": "–ö–∞–π—Ñ—É—Ä",
              "estimatedDate": "–î–∞—Ç—ã –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã",
              "color": "linear-gradient(135deg, #ef4444, #f97316, #eab308, #22c55e, #3b82f6, #a855f7, #ec4899)",
              "category": "convention",
              "location": "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ",
              "description": "–õ—É—á—à–∏–π –∫–æ–Ω.",
              "url": ""
            }
          ]
        };

        const months = [
            "–Ø–Ω–≤–∞—Ä—å", "–§–µ–≤—Ä–∞–ª—å", "–ú–∞—Ä—Ç", "–ê–ø—Ä–µ–ª—å", "–ú–∞–π", "–ò—é–Ω—å",
            "–ò—é–ª—å", "–ê–≤–≥—É—Å—Ç", "–°–µ–Ω—Ç—è–±—Ä—å", "–û–∫—Ç—è–±—Ä—å", "–ù–æ—è–±—Ä—å", "–î–µ–∫–∞–±—Ä—å"
        ];
        
        const daysOfWeek = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"];
        
        // State for filtering
        let activeCategories = new Set(appData.categories.map(c => c.id));

        function init() {
            renderLegend();
            renderStats();
            renderCalendar();
            renderTentativeEvents();
            setupModal();
        }

        function toggleCategory(catId) {
            if (activeCategories.has(catId)) {
                activeCategories.delete(catId);
            } else {
                activeCategories.add(catId);
            }
            renderLegend();
            renderCalendar();
            renderTentativeEvents();
            renderStats(); 
        }

        function renderLegend() {
            const container = document.getElementById('legend');
            container.innerHTML = ''; // Clear existing
            appData.categories.forEach(cat => {
                if (cat.id === 'tentative') return; 
                
                const isActive = activeCategories.has(cat.id);
                const div = document.createElement('button');
                div.className = `cursor-pointer flex items-center gap-1.5 px-2 py-1 rounded transition-all ${isActive ? 'bg-white shadow-sm ring-1 ring-slate-200' : 'opacity-50 grayscale'}`;
                div.innerHTML = `
                    <span class="w-3 h-3 rounded-full" style="background-color: ${cat.color}"></span>
                    <span class="text-slate-600 font-medium">${cat.name}</span>
                `;
                div.onclick = () => toggleCategory(cat.id);
                container.appendChild(div);
            });
        }

        function renderStats() {
            // Filter events
            const visibleEvents = appData.events.filter(e => activeCategories.has(e.category));
            
            // Count
            document.getElementById('total-events-count').innerText = visibleEvents.length;

            // Nearest event
            const sortedEvents = [...visibleEvents].sort((a, b) => a.startDate.localeCompare(b.startDate));
            
            const nextEvent = sortedEvents[0];
            const widget = document.getElementById('next-event-widget');
            
            if (nextEvent) {
                widget.innerHTML = `
                    <div class="flex items-center gap-2">
                        <div class="w-1 h-8 rounded-full" style="background: ${nextEvent.color}"></div>
                        <div>
                            <p class="font-bold text-slate-800 leading-tight">${nextEvent.title}</p>
                            <p class="text-xs text-slate-500">${formatDate(nextEvent.startDate)}</p>
                        </div>
                    </div>
                `;
            } else {
                widget.innerHTML = `<p class="text-sm text-slate-400">–ù–µ—Ç –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏—Ö —Å–æ–±—ã—Ç–∏–π</p>`;
            }
        }

        function renderCalendar() {
            const container = document.getElementById('calendar-container');
            container.innerHTML = ''; // Clear for re-render
            const year = 2026;

            // Map events to dates for O(1) lookup
            const eventsByDate = {};
            
            appData.events.forEach(event => {
                // Filter check
                if (!activeCategories.has(event.category)) return;

                let current = new Date(event.startDate);
                const end = new Date(event.endDate);
                
                while (current <= end) {
                    const dateStr = current.toISOString().split('T')[0];
                    if (!eventsByDate[dateStr]) eventsByDate[dateStr] = [];
                    eventsByDate[dateStr].push(event);
                    
                    current.setDate(current.getDate() + 1);
                }
            });

            months.forEach((monthName, index) => {
                const monthDiv = document.createElement('div');
                monthDiv.className = "bg-white p-4 rounded-xl shadow-sm border border-slate-100";
                
                // Header
                const header = document.createElement('div');
                header.className = "flex justify-between items-center mb-3";
                header.innerHTML = `<h3 class="font-bold text-lg text-slate-700">${monthName}</h3>`;
                monthDiv.appendChild(header);

                // Weekdays
                const grid = document.createElement('div');
                grid.className = "month-grid";
                
                daysOfWeek.forEach(d => {
                    const dayHeader = document.createElement('div');
                    dayHeader.className = "text-center text-xs text-slate-400 font-medium py-1";
                    dayHeader.innerText = d;
                    grid.appendChild(dayHeader);
                });

                // Days
                const firstDay = new Date(year, index, 1);
                const lastDay = new Date(year, index + 1, 0);
                const daysInMonth = lastDay.getDate();
                
                // 0 = Sunday, 1 = Monday... but we want Mon=0, Sun=6
                let startDayOfWeek = firstDay.getDay() - 1; 
                if (startDayOfWeek === -1) startDayOfWeek = 6;

                // Empty cells before start
                for (let i = 0; i < startDayOfWeek; i++) {
                    grid.appendChild(document.createElement('div'));
                }

                // Days
                for (let d = 1; d <= daysInMonth; d++) {
                    const dateStr = `${year}-${String(index + 1).padStart(2, '0')}-${String(d).padStart(2, '0')}`;
                    const dayCell = document.createElement('div');
                    dayCell.className = "day-cell rounded-full hover:bg-slate-50 transition-colors";
                    dayCell.innerText = d;

                    if (eventsByDate[dateStr]) {
                        const events = eventsByDate[dateStr];
                        const mainEvent = events[0];
                        
                        dayCell.classList.add('has-event');
                        dayCell.style.background = mainEvent.color;
                        dayCell.title = events.map(e => e.title).join(', ');
                        
                        dayCell.addEventListener('click', () => openModal(events));
                    }

                    grid.appendChild(dayCell);
                }

                monthDiv.appendChild(grid);
                container.appendChild(monthDiv);
            });
        }

        function renderTentativeEvents() {
            const container = document.getElementById('tentative-container');
            container.innerHTML = ''; // Clear for re-render
            
            const visibleEvents = appData.tentativeEvents.filter(e => activeCategories.has(e.category));
            
            if (visibleEvents.length === 0) {
                 container.innerHTML = '<p class="text-slate-400 col-span-full text-center italic">–ù–µ—Ç —Å–æ–±—ã—Ç–∏–π –≤ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö.</p>';
                 return;
            }

            visibleEvents.forEach(event => {
                const card = document.createElement('div');
                card.className = "bg-white p-5 rounded-xl shadow-sm border border-slate-200 hover:shadow-md transition-shadow relative overflow-hidden";
                
                card.innerHTML = `
                    <div class="absolute top-0 left-0 w-1 h-full" style="background: ${event.color}"></div>
                    <div class="flex justify-between items-start mb-2">
                        <h4 class="font-bold text-slate-800 text-lg">${event.title}</h4>
                        <span class="text-xs font-semibold bg-slate-100 text-slate-500 px-2 py-1 rounded">
                            ${event.estimatedDate}
                        </span>
                    </div>
                    <p class="text-sm text-slate-600 mb-3">${event.description}</p>
                    ${event.url ? `<a href="${event.url}" target="_blank" class="text-sm text-blue-600 hover:underline inline-flex items-center gap-1">–£–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ <span>&rarr;</span></a>` : ''}
                `;
                
                container.appendChild(card);
            });
        }

        // Modal Logic
        const modal = document.getElementById('event-modal');
        const closeModalBtn = document.getElementById('close-modal');
        
        function setupModal() {
            closeModalBtn.addEventListener('click', () => {
                modal.classList.remove('active');
            });
            modal.addEventListener('click', (e) => {
                if (e.target === modal) modal.classList.remove('active');
            });
            document.addEventListener('keydown', (e) => {
                if (e.key === "Escape" && modal.classList.contains('active')) {
                    modal.classList.remove('active');
                }
            });
        }

        function openModal(events) {
            // If multiple events on one day, ideally we show a list or handle selection.
            // For simplicity, we'll show the first event, or maybe list titles if multiple?
            // Let's just show the first one for now as data seems to have minimal overlaps.
            const event = events[0];
            
            // Populate
            document.getElementById('modal-title').innerText = event.title;
            document.getElementById('modal-description').innerText = event.description;
            document.getElementById('modal-dates').innerText = `${formatDate(event.startDate)} ‚Äî ${formatDate(event.endDate)}`;
            document.getElementById('modal-header-bg').style.background = event.color;
            document.getElementById('modal-date-badge').innerHTML = getBadgeDate(event.startDate);
            document.getElementById('modal-date-badge').className = `px-3 py-1 rounded text-sm text-center min-w-[60px] font-bold bg-white/90 shadow-sm`;
            document.getElementById('modal-date-badge').style.color = event.color;

            // Category name lookup
            const cat = appData.categories.find(c => c.id === event.category);
            document.getElementById('modal-category').innerText = cat ? cat.name : event.category;

            // Location
            const locEl = document.getElementById('modal-location-container');
            if (event.location) {
                locEl.style.display = 'flex';
                document.getElementById('modal-location').innerText = event.location;
            } else {
                locEl.style.display = 'none';
            }

            // Link
            const linkBtn = document.getElementById('modal-link');
            if (event.url) {
                linkBtn.style.display = 'inline-flex';
                linkBtn.href = event.url;
                linkBtn.style.backgroundColor = event.color;
            } else {
                linkBtn.style.display = 'none';
            }

            modal.classList.add('active');
        }

        function formatDate(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleDateString('ru-RU', { day: 'numeric', month: 'long' });
        }

        function getBadgeDate(dateStr) {
            const date = new Date(dateStr);
            const month = date.toLocaleDateString('ru-RU', { month: 'short' }).toUpperCase().replace('.', '');
            const day = String(date.getDate()).padStart(2, '0');
            return `${month}<br><span class="text-xl">${day}</span>`;
        }

        // Run
        document.addEventListener('DOMContentLoaded', init);

    </script>
</body>
</html>
